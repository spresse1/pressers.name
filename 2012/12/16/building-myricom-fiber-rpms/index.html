<!doctype html><html lang=en><head><title>Building the ACM Cluster, Part 11d: Building Myricom fiber RPMs - The Electronic Press</title><meta charset=utf-8><meta http-equiv=cache-control content="public"><meta name=robots content="follow, all"><meta name=language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Welcome back to my ongoing series on building the JHUACM VM cluster. In this part, I&rsquo;m going to be focusing on building the RPM driver for the Myricom fiber cards that were given to us with the cluster. Unfortunately the drivers for this are closed source. However, through my connections to physics, I was able to get source code to build from. In short, if you&rsquo;re here looking for drivers, you&rsquo;re out of luck - go talk to Myricom."><meta name=keywords content><link rel=alternate type=application/rss+xml title="RSS Feed for pressers.name" href=/index.xml><link rel=stylesheet type=text/css media="screen, projection" href=/static/css/base.css><link rel=stylesheet type=text/css media="screen, projection" href=/static/css/cssmenu.css><link rel=stylesheet type=text/css media="screen, projection" href=/static/css/menustyling.css><link rel=stylesheet type=text/css media="screen, projection" href=/static/css/blog.css><link rel=stylesheet type=text/css media=print href=/static/css/print.css></head><body><div id=skip><a href=#content>Skip to Main Content</a></div><div id=leftbar></div><div id=contentwrapper><div id=header><div id=titleimagediv></div><div id=twotraces><div id=twotracesright>&nbsp;</div></div></div><div class=menu id=topmenu><nav><ul class=top-navigation><li><a href=/ title=Home rel=home>Home</a></li><li><a href=http://github.com/spresse1>GitHub</a></li><li><a href=/contact>Contact</a></li></ul></nav></div><div id=onetrace><div id=onetraceleft></div><div id=breadcrumbs class=breadcrumbs><nav><ul class=breadcrumbs><li><a href=/>Home</a></li><li><a href=/blog/>Blogs</a></li><li><a href=/2012/12/16/building-myricom-fiber-rpms/>Building the ACM Cluster, Part 11d: Building Myricom fiber RPMs</a></li></ul></nav></div></div><div id=bodywrapper><div id=content><div id=contentborder></div><div id=innercontent><main><div class=hentry><article itemtype=http://schema.org/Article itemscope id=blog/acm-cluster/building-myricom-fiber-rpms.md><header class=entry-header><h1 class=entry-title><a href=/2012/12/16/building-myricom-fiber-rpms/>Building the ACM Cluster, Part 11d: Building Myricom fiber RPMs</a></h1><p class=entry-info>Published on <time>Sun, Dec 16, 2012</time>
in ACM, ACM Cluster</p></header><div class=entry-body><p>Welcome back to my ongoing series on building the JHUACM VM cluster.  In this part, I&rsquo;m going to be focusing on building the RPM driver for the Myricom fiber cards that were given to us with the cluster.  Unfortunately the drivers for this are closed source.  However, through my connections to physics, I was able to get source code to build from.  In short, if you&rsquo;re here looking for drivers, you&rsquo;re out of luck - go talk to Myricom.</p><p>The specific hardware we have is driven by the mx2g driver, so that is what I&rsquo;ll be working on.</p><h1 id=down-the-rabbit-hole>Down the Rabbit Hole</h1><p>The first thing I did when I got the tarball of the driver source was try to build the rpm.  The normal RPM build process is to copy the source tarball and a spec file into rpmbuild.  With these, it was some convoluted, undocumented and inflexible process.  In short, the process was to run &ldquo;make rpm&rdquo;, copy a magic folder somewhere magical, and then run rpmbuild against the spec file.  This also deliberately limited the install location to /opt/mx, which I thought was a poor practice.</p><p>So I rewrote the spec file.  Since this is entirely my work, I feel comfortable releasing it publicly, even though the rest of the source isn&rsquo;t.  This spec file is therefore released without restriction.  In order to make sure you get the most recent version, please get the file <a href=https://github.com/spresse1/acm-vm-cluster/blob/master/mx/mx.spec>from my github</a>.</p><p>I&rsquo;ve done my best to retain parity with the Myricom spec file.  However, the advantage of this spec file is that it installs the driver in sane, normal places.</p><p>To build the Myricom MX2 driver with this file, copy the spec file to <code>rpmbuild/SPECS</code> and the source tarball (mx2g_1.2.16.tar.gz in this case) to <code>rpmbuild/SOURCES</code>.  Then build it just like you were building any other RPM.</p><h1 id=build-process>Build Process</h1><p>The build process here is much the same as the process documented elsewhere in this setup document.  Copy <a href=https://github.com/spresse1/acm-vm-cluster/blob/master/mx/mx.spec>the spec file</a> to <code>rpmbuild/SPECS</code> and the source tarball to <code>rpmbuild/SOURCES</code>.  You&rsquo;ll also want the patch <a href=https://github.com/spresse1/acm-vm-cluster/blob/master/mx/mx-update-to-3.x.patch>I made available on GitHub</a> to fox the mx2g source for linux 3.x kernels.  Then run</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ rpmbuild -ba mx.spec
</span></span></code></pre></div><p>Finally, <a href=/2012/12/15/building-acm-cluster-part-11b-kernel-rpm-build/>inject it into the package repository as before</a>.</p></div></article></div></main></div></div><div id=sidebar><div class=widget><nav><h1>Recent Posts</h1><ul class=entries-reent><li><a href=/2022/04/03/website-hosting-changed/>Website hosting changed</a></li><li><a href=/2022/02/01/enigma-2022/>Enigma 2022</a></li><li><a href=/2021/11/21/getting-new-lenses-lensfun-notes/>Getting new lenses for Lensfun</a></li><li><a href=/2021/10/04/living-germany-converting-drivers-license/>Living in Germany: Converting a Driver's License</a></li><li><a href=/2021/02/08/im-moving-germany/>I'm moving to Germany!</a></li></ul></nav></div><div class=sidebarbender></div><div class=widget><nav><h1>Social Media</h1><ul class=socialmedia><li><a href=https://twitter.com/spresser>Twitter</a></li><li><a href=https://www.linkedin.com/in/steven-presser/>LinkedIn</a></li></ul></nav></div><div class=sidebarbender></div><div class=widget><nav><h1>Categories</h1><ul class=categories><li><a href=/categories/3d-printing/>3D Printing</a></li><li><a href=/categories/acm/>ACM</a></li><li><a href=/categories/acm-cluster/>ACM Cluster</a></li><li><a href=/categories/cyberlaw/>Cyberlaw</a></li><li><a href=/categories/cybersecurity/>Cybersecurity</a></li><li><a href=/categories/germany/>Germany</a></li><li><a href=/categories/infrastructure/>Infrastructure</a></li><li><a href=/categories/life-in-germany/>Life in Germany</a></li><li><a href=/categories/links/>Links</a></li><li><a href=/categories/presentations/>Presentations</a></li><li><a href=/categories/projects/>Projects</a></li><li><a href=/categories/shrubbery/>Shrubbery</a></li></ul></nav></div><div class=sidebarbender></div></div></div><div id=onetracebottom><footer><a href=https://github.com/spresse1/pressers.name>Website source</a><br>Site design by Kyle M.</footer></div></div></body></html>